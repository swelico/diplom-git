{% extends 'main/base.html' %}
{% load static %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç{% endblock title %}

{% block content %}
<div class="profile-container">
    <div class="profile-card">
        <div class="profile-header">
            <h2 class="profile-title">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
            <div class="profile-divider"></div>
        </div>
        
        <div class="profile-content">
            <form action="{% url 'users:profile' %}" method="post" enctype="multipart/form-data" class="profile-form">
                {% csrf_token %}
                <div class="profile-layout">
                    <div class="profile-sidebar">
                        <div class="avatar-container">
                            {% if user.image %}
                                <img src="{{ user.image.url }}" alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" class="avatar-image">
                            {% else %}
                                <img src="{% static 'img/noimage.jpg' %}" alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" class="avatar-image">
                            {% endif %}
                            <div class="avatar-upload">
                                <label for="id_image" class="avatar-label">–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ</label>
                                <input type="file" class="avatar-input" id="id_image" name="image" accept="image/*">
                            </div>
                        </div>
                        
                        <div class="profile-actions">
                            <button type="submit" class="btn btn-primary profile-save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                            <a class="btn btn-accent profile-logout-btn" href="{% url 'user:logout' %}">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</a> 
                        </div>
                    </div>
                    
                    <div class="profile-details">
                        <div class="form-group">
                            <label for="id_first_name" class="form-label">–ò–º—è</label>
                            <input type="text" class="form-control" id="id_first_name" name="first_name" 
                                placeholder="–í–∞—à–µ –∏–º—è" value="{{ form.first_name.value }}" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="id_last_name" class="form-label">–§–∞–º–∏–ª–∏—è</label>
                            <input type="text" class="form-control" id="id_last_name" name="last_name" 
                                placeholder="–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è" value="{{ form.last_name.value }}" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="id_username" class="form-label">–ù–∏–∫–Ω–µ–π–º</label>
                            <input type="text" class="form-control" id="id_username" name="username" 
                                placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º" value="{{ form.username.value }}" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="id_email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="id_email" name="email" 
                                placeholder="–í–∞—à Email" value="{{ form.email.value }}" required>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <div class="orders-card">
        <div class="orders-header">
            <h2 class="orders-title">–í–∞—à–∏ –∑–∞–∫–∞–∑—ã</h2>
            <div class="orders-divider"></div>
        </div>
        
        <div class="orders-content">
            {% if orders %}
                <div class="orders-list">
                    {% for order in orders %}
                        <div class="order-item">
                            <div class="order-item-header">
                                <h5 class="order-item-title">–ó–∞–∫–∞–∑ ‚Ññ {{ order.id }}</h5>
                                <span class="order-item-date">{{ order.created }}</span>
                            </div>
                            
                            <div class="order-item-content">
                                {% for item in order.items.all %}
                                    <div class="order-product">
                                        <div class="order-product-info">
                                            <div class="order-product-name">
                                                <span class="order-label">–ö—É—Ä—Å:</span>
                                                <a class="order-product-link" href="{% url 'main:product_detail' item.product.slug %}">
                                                    {{ item.product.name }}
                                                </a>
                                            </div>
                                            
                                            <div class="order-product-details">
                                                <div class="order-detail">
                                                    <span class="order-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</span>
                                                    <span class="order-value">{{ item.quantity }}</span>
                                                </div>
                                                
                                                <div class="order-detail">
                                                    <span class="order-label">–°—Ç–æ–∏–º–æ—Å—Ç—å:</span>
                                                    <span class="order-value order-price">{{ item.price }}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-orders">
                    <div class="empty-orders-icon">üì¶</div>
                    <h4 class="empty-orders-title">–£ –í–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</h4>
                    <p class="empty-orders-text">–ö–æ–≥–¥–∞ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ –∑–∞–∫–∞–∑, –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</p>
                    <a href="{% url 'main:product_list' %}" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫—É—Ä—Å–∞–º</a>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}